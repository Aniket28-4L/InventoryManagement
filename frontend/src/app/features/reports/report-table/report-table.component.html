<div class="space-y-4">
  <div class="flex items-center justify-between flex-wrap gap-3">
    <h1 class="page-title">Reports</h1>
    <div class="flex gap-2">
      <button class="btn btn-secondary" (click)="loadReports()" [disabled]="loading">
        <lucide-icon name="refresh-cw" class="h-4 w-4" [class.animate-spin]="loading"></lucide-icon>
        Refresh
      </button>
      <button class="btn btn-secondary" (click)="exportReport()" [disabled]="loading || reports.length === 0">
        <lucide-icon name="download" class="h-4 w-4"></lucide-icon>
        Export
      </button>
    </div>
  </div>

  <div class="card p-4 space-y-4">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
      <div>
        <label class="label">Report Type</label>
        <select class="input" [(ngModel)]="reportType" (change)="loadReports()">
          <option value="stock">Stock Report</option>
          <option value="warehouse">Warehouse Report</option>
          <option value="movement">Movement Report</option>
          <option value="lowStock">Low Stock Report</option>
        </select>
      </div>
      <div>
        <label class="label">Warehouse</label>
        <select class="input" [(ngModel)]="selectedWarehouse" (change)="loadReports()">
          <option value="">All Warehouses</option>
          <option *ngFor="let wh of warehouses" [value]="wh.id">{{ wh.name }}</option>
        </select>
      </div>
      <div>
        <label class="label">Date</label>
        <input type="date" class="input" [(ngModel)]="dateFrom" (change)="loadReports()" />
      </div>
    </div>
  </div>

  <div class="card p-4">
    <div *ngIf="loading" class="flex items-center justify-center py-12">
      <app-spinner class="h-6 w-6"></app-spinner>
    </div>

    <div *ngIf="!loading && reports.length === 0" class="text-center py-12 text-gray-500">
      No report data found.
    </div>

    <div *ngIf="!loading && reports.length > 0" class="overflow-x-auto">
      <table class="min-w-full divide-y divide-neutral-200">
        <thead class="bg-neutral-50">
          <tr>
            <th *ngIf="reportType === 'stock' || reportType === 'lowStock'" class="px-6 py-3 text-left text-xs font-semibold text-neutral-600 uppercase tracking-wider">Product</th>
            <th *ngIf="reportType === 'stock' || reportType === 'lowStock'" class="px-6 py-3 text-left text-xs font-semibold text-neutral-600 uppercase tracking-wider">Warehouse</th>
            <th *ngIf="reportType === 'stock' || reportType === 'lowStock'" class="px-6 py-3 text-right text-xs font-semibold text-neutral-600 uppercase tracking-wider">Quantity</th>
            
            <th *ngIf="reportType === 'warehouse'" class="px-6 py-3 text-left text-xs font-semibold text-neutral-600 uppercase tracking-wider">Warehouse</th>
            <th *ngIf="reportType === 'warehouse'" class="px-6 py-3 text-left text-xs font-semibold text-neutral-600 uppercase tracking-wider">Code</th>
            <th *ngIf="reportType === 'warehouse'" class="px-6 py-3 text-right text-xs font-semibold text-neutral-600 uppercase tracking-wider">Total Items</th>
            <th *ngIf="reportType === 'warehouse'" class="px-6 py-3 text-right text-xs font-semibold text-neutral-600 uppercase tracking-wider">Available Items</th>
            <th *ngIf="reportType === 'warehouse'" class="px-6 py-3 text-right text-xs font-semibold text-neutral-600 uppercase tracking-wider">Products</th>
            
            <th *ngIf="reportType === 'movement'" class="px-6 py-3 text-left text-xs font-semibold text-neutral-600 uppercase tracking-wider">Date</th>
            <th *ngIf="reportType === 'movement'" class="px-6 py-3 text-left text-xs font-semibold text-neutral-600 uppercase tracking-wider">Product</th>
            <th *ngIf="reportType === 'movement'" class="px-6 py-3 text-left text-xs font-semibold text-neutral-600 uppercase tracking-wider">Type</th>
            <th *ngIf="reportType === 'movement'" class="px-6 py-3 text-right text-xs font-semibold text-neutral-600 uppercase tracking-wider">Quantity</th>
            <th *ngIf="reportType === 'movement'" class="px-6 py-3 text-left text-xs font-semibold text-neutral-600 uppercase tracking-wider">From</th>
            <th *ngIf="reportType === 'movement'" class="px-6 py-3 text-left text-xs font-semibold text-neutral-600 uppercase tracking-wider">To</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-neutral-100">
          <tr *ngFor="let report of reports" class="hover:bg-neutral-50 transition-colors">
            <!-- Stock and Low Stock Reports -->
            <td *ngIf="reportType === 'stock' || reportType === 'lowStock'" class="px-6 py-4 text-sm font-medium text-brand-700">{{ report.product?.name || '-' }}</td>
            <td *ngIf="reportType === 'stock' || reportType === 'lowStock'" class="px-6 py-4 text-sm text-neutral-700">{{ report.warehouse?.name || '-' }}</td>
            <td *ngIf="reportType === 'stock' || reportType === 'lowStock'" class="px-6 py-4 text-sm text-right font-medium">{{ report.qty || report.quantity || 0 }}</td>
            
            <!-- Warehouse Reports -->
            <td *ngIf="reportType === 'warehouse'" class="px-6 py-4 text-sm font-medium text-brand-700">{{ report.warehouse?.name || '-' }}</td>
            <td *ngIf="reportType === 'warehouse'" class="px-6 py-4 text-sm text-neutral-700">{{ report.warehouse?.code || '-' }}</td>
            <td *ngIf="reportType === 'warehouse'" class="px-6 py-4 text-sm text-right font-medium">{{ report.totalItems || 0 }}</td>
            <td *ngIf="reportType === 'warehouse'" class="px-6 py-4 text-sm text-right font-medium">{{ report.availableItems || 0 }}</td>
            <td *ngIf="reportType === 'warehouse'" class="px-6 py-4 text-sm text-right font-medium">{{ report.productCount || 0 }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
