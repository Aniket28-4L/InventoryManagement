{"ast":null,"code":"import _asyncToGenerator from \"F:/Inventory Management/InventoryManagement/frontend/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ToastrService } from 'ngx-toastr';\nimport { ProductsService } from '../../../core/services/products.service';\nimport { WarehouseService } from '../../../core/services/warehouse.service';\nimport { AuthService } from '../../../core/services/auth.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../../core/services/products.service\";\nimport * as i3 from \"../../../core/services/warehouse.service\";\nimport * as i4 from \"../../../core/services/auth.service\";\nimport * as i5 from \"ngx-toastr\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/forms\";\nimport * as i8 from \"../../../shared/components/spinner/spinner.component\";\nimport * as i9 from \"../../../shared/components/modal/modal.component\";\nimport * as i10 from \"../../../shared/components/barcode-preview/barcode-preview.component\";\nimport * as i11 from \"../../../shared/components/lucide-icon/lucide-icon.component\";\nconst _c0 = a0 => [\"/products\", a0, \"edit\"];\nconst _c1 = (a0, a1, a2) => ({\n  \"bg-red-50 border-red-200\": a0,\n  \"bg-orange-50 border-orange-200\": a1,\n  \"bg-blue-50 border-blue-200\": a2\n});\nconst _c2 = (a0, a1) => ({\n  \"text-red-600 font-bold\": a0,\n  \"text-gray-900\": a1\n});\nconst _c3 = (a0, a1) => ({\n  \"text-orange-600 font-semibold\": a0,\n  \"text-gray-700\": a1\n});\nconst _c4 = (a0, a1) => ({\n  \"bg-red-50/30\": a0,\n  \"bg-orange-50/30\": a1\n});\nconst _c5 = a0 => ({\n  \"text-red-600 font-bold\": a0\n});\nconst _c6 = (a0, a1, a2) => ({\n  \"text-orange-600 font-semibold\": a0,\n  \"text-green-600\": a1,\n  \"text-gray-500\": a2\n});\nfunction ProductDetailComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 3);\n    i0.ɵɵelement(1, \"app-spinner\", 4);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductDetailComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵtext(1, \" Product not found.\\n\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductDetailComponent_div_2_div_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 33);\n    i0.ɵɵelement(1, \"app-barcode-preview\", 34)(2, \"app-barcode-preview\", 35);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"value\", ctx_r1.product.barcode);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"value\", ctx_r1.product.barcode);\n  }\n}\nfunction ProductDetailComponent_div_2_div_55_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵtext(1, \"No barcode available.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductDetailComponent_div_2_div_63_lucide_icon_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"lucide-icon\", 45);\n  }\n}\nfunction ProductDetailComponent_div_2_div_63_lucide_icon_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"lucide-icon\", 46);\n  }\n}\nfunction ProductDetailComponent_div_2_div_63_button_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 47);\n    i0.ɵɵlistener(\"click\", function ProductDetailComponent_div_2_div_63_button_14_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r1.showAddStockModal = true);\n    });\n    i0.ɵɵtext(1, \" Add Stock Now \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductDetailComponent_div_2_div_63_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 48);\n    i0.ɵɵtext(1, \" \\u26A0\\uFE0F This product is out of stock. Consider adding stock to meet demand. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductDetailComponent_div_2_div_63_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 49);\n    i0.ɵɵtext(1, \" \\u26A0\\uFE0F All available stock is currently reserved. No stock available for new orders. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductDetailComponent_div_2_div_63_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 36)(1, \"div\", 7)(2, \"div\", 9);\n    i0.ɵɵtemplate(3, ProductDetailComponent_div_2_div_63_lucide_icon_3_Template, 1, 0, \"lucide-icon\", 37)(4, ProductDetailComponent_div_2_div_63_lucide_icon_4_Template, 1, 0, \"lucide-icon\", 38);\n    i0.ɵɵelementStart(5, \"div\")(6, \"div\", 39);\n    i0.ɵɵtext(7, \" Total Stock: \");\n    i0.ɵɵelementStart(8, \"span\", 40);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"div\", 41);\n    i0.ɵɵtext(11, \" Available: \");\n    i0.ɵɵelementStart(12, \"span\", 40);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵtemplate(14, ProductDetailComponent_div_2_div_63_button_14_Template, 2, 0, \"button\", 42);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(15, ProductDetailComponent_div_2_div_63_div_15_Template, 2, 0, \"div\", 43)(16, ProductDetailComponent_div_2_div_63_div_16_Template, 2, 0, \"div\", 44);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(10, _c1, ctx_r1.hasZeroStock, ctx_r1.hasLowStock && !ctx_r1.hasZeroStock, !ctx_r1.hasZeroStock && !ctx_r1.hasLowStock));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.hasZeroStock);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.hasLowStock && !ctx_r1.hasZeroStock);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(14, _c2, ctx_r1.hasZeroStock, !ctx_r1.hasZeroStock));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r1.totalStock);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(17, _c3, ctx_r1.hasLowStock, !ctx_r1.hasLowStock));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r1.totalAvailable);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.hasZeroStock);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.hasZeroStock);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.hasLowStock && !ctx_r1.hasZeroStock);\n  }\n}\nfunction ProductDetailComponent_div_2_div_64_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 50);\n    i0.ɵɵelement(1, \"app-spinner\", 51);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductDetailComponent_div_2_div_65_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 52);\n    i0.ɵɵtext(1, \" No stock entries found. Add stock to get started. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductDetailComponent_div_2_div_66_tr_17_lucide_icon_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"lucide-icon\", 71);\n  }\n}\nfunction ProductDetailComponent_div_2_div_66_tr_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 60)(1, \"td\", 61);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 62);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 63)(6, \"div\", 64);\n    i0.ɵɵtemplate(7, ProductDetailComponent_div_2_div_66_tr_17_lucide_icon_7_Template, 1, 0, \"lucide-icon\", 65);\n    i0.ɵɵelementStart(8, \"span\", 40);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(10, \"td\", 66)(11, \"span\", 40);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"td\", 67);\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"td\", 68)(16, \"button\", 69);\n    i0.ɵɵlistener(\"click\", function ProductDetailComponent_div_2_div_66_tr_17_Template_button_click_16_listener() {\n      const item_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r1.openAdjustModal(item_r5));\n    });\n    i0.ɵɵelement(17, \"lucide-angular\", 70);\n    i0.ɵɵtext(18, \" Adjust \");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const item_r5 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(3);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(11, _c4, (item_r5.qty || 0) === 0, (item_r5.qty || 0) > 0 && (item_r5.availableQty || 0) === 0));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate((item_r5.warehouse == null ? null : item_r5.warehouse.name) || (item_r5.warehouse == null ? null : item_r5.warehouse.code) || \"Unknown\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.formatLocation(item_r5.location), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", (item_r5.qty || 0) === 0);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(14, _c5, (item_r5.qty || 0) === 0));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(item_r5.qty || 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(16, _c6, (item_r5.qty || 0) > 0 && (item_r5.availableQty || 0) === 0, (item_r5.availableQty || 0) > 0, (item_r5.availableQty || 0) === 0));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(item_r5.availableQty || 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r5.reservedQty || 0);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"name\", ctx_r1.Edit2)(\"size\", 14);\n  }\n}\nfunction ProductDetailComponent_div_2_div_66_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 53)(1, \"table\", 54)(2, \"thead\")(3, \"tr\", 55)(4, \"th\", 56);\n    i0.ɵɵtext(5, \"Warehouse\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\", 56);\n    i0.ɵɵtext(7, \"Location\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\", 57);\n    i0.ɵɵtext(9, \"Quantity\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\", 57);\n    i0.ɵɵtext(11, \"Available\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\", 57);\n    i0.ɵɵtext(13, \"Reserved\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\", 58);\n    i0.ɵɵtext(15, \"Actions\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(16, \"tbody\");\n    i0.ɵɵtemplate(17, ProductDetailComponent_div_2_div_66_tr_17_Template, 19, 20, \"tr\", 59);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(17);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.stock);\n  }\n}\nfunction ProductDetailComponent_div_2_app_modal_67_option_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 83);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const wh_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", wh_r7._id || wh_r7.id);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" \", wh_r7.name, \" \", wh_r7.code ? \"(\" + wh_r7.code + \")\" : \"\", \" \");\n  }\n}\nfunction ProductDetailComponent_div_2_app_modal_67_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-modal\", 72);\n    i0.ɵɵlistener(\"close\", function ProductDetailComponent_div_2_app_modal_67_Template_app_modal_close_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      ctx_r1.showAddStockModal = false;\n      return i0.ɵɵresetView(ctx_r1.stockForm = {\n        warehouseId: \"\",\n        qty: \"\",\n        locationId: \"\"\n      });\n    });\n    i0.ɵɵelementStart(1, \"form\", 73);\n    i0.ɵɵlistener(\"ngSubmit\", function ProductDetailComponent_div_2_app_modal_67_Template_form_ngSubmit_1_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.handleAddStock($event));\n    });\n    i0.ɵɵelementStart(2, \"div\")(3, \"label\", 74);\n    i0.ɵɵtext(4, \"Warehouse \");\n    i0.ɵɵelementStart(5, \"span\", 75);\n    i0.ɵɵtext(6, \"*\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"select\", 76);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProductDetailComponent_div_2_app_modal_67_Template_select_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r1.stockForm.warehouseId, $event) || (ctx_r1.stockForm.warehouseId = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementStart(8, \"option\", 77);\n    i0.ɵɵtext(9, \"Select warehouse\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(10, ProductDetailComponent_div_2_app_modal_67_option_10_Template, 2, 3, \"option\", 78);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"div\")(12, \"label\", 74);\n    i0.ɵɵtext(13, \"Quantity \");\n    i0.ɵɵelementStart(14, \"span\", 75);\n    i0.ɵɵtext(15, \"*\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"input\", 79);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProductDetailComponent_div_2_app_modal_67_Template_input_ngModelChange_16_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r1.stockForm.qty, $event) || (ctx_r1.stockForm.qty = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"div\", 80)(18, \"button\", 81);\n    i0.ɵɵtext(19, \"Add Stock\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"button\", 82);\n    i0.ɵɵlistener(\"click\", function ProductDetailComponent_div_2_app_modal_67_Template_button_click_20_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      ctx_r1.showAddStockModal = false;\n      return i0.ɵɵresetView(ctx_r1.stockForm = {\n        warehouseId: \"\",\n        qty: \"\",\n        locationId: \"\"\n      });\n    });\n    i0.ɵɵtext(21, \"Cancel\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"open\", ctx_r1.showAddStockModal);\n    i0.ɵɵadvance(7);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.stockForm.warehouseId);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.warehouses);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.stockForm.qty);\n  }\n}\nfunction ProductDetailComponent_div_2_app_modal_68_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-modal\", 84);\n    i0.ɵɵlistener(\"close\", function ProductDetailComponent_div_2_app_modal_68_Template_app_modal_close_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      ctx_r1.showAdjustStockModal = false;\n      ctx_r1.selectedStock = null;\n      return i0.ɵɵresetView(ctx_r1.stockForm = {\n        warehouseId: \"\",\n        qty: \"\",\n        locationId: \"\"\n      });\n    });\n    i0.ɵɵelementStart(1, \"form\", 73);\n    i0.ɵɵlistener(\"ngSubmit\", function ProductDetailComponent_div_2_app_modal_68_Template_form_ngSubmit_1_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.handleAdjustStock($event));\n    });\n    i0.ɵɵelementStart(2, \"div\")(3, \"label\", 74);\n    i0.ɵɵtext(4, \"Warehouse\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(5, \"input\", 85);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\")(7, \"label\", 74);\n    i0.ɵɵtext(8, \"Quantity \");\n    i0.ɵɵelementStart(9, \"span\", 75);\n    i0.ɵɵtext(10, \"*\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"input\", 86);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProductDetailComponent_div_2_app_modal_68_Template_input_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r1.stockForm.qty, $event) || (ctx_r1.stockForm.qty = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"p\", 87);\n    i0.ɵɵtext(13, \"Set the exact quantity for this warehouse\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"div\", 80)(15, \"button\", 81);\n    i0.ɵɵtext(16, \"Update Stock\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"button\", 82);\n    i0.ɵɵlistener(\"click\", function ProductDetailComponent_div_2_app_modal_68_Template_button_click_17_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      ctx_r1.showAdjustStockModal = false;\n      ctx_r1.selectedStock = null;\n      return i0.ɵɵresetView(ctx_r1.stockForm = {\n        warehouseId: \"\",\n        qty: \"\",\n        locationId: \"\"\n      });\n    });\n    i0.ɵɵtext(18, \"Cancel\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"open\", ctx_r1.showAdjustStockModal);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"value\", (ctx_r1.selectedStock.warehouse == null ? null : ctx_r1.selectedStock.warehouse.name) || (ctx_r1.selectedStock.warehouse == null ? null : ctx_r1.selectedStock.warehouse.code) || \"Unknown\");\n    i0.ɵɵadvance(6);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.stockForm.qty);\n  }\n}\nfunction ProductDetailComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 6)(1, \"div\", 7)(2, \"h1\", 8);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 9)(5, \"a\", 10);\n    i0.ɵɵtext(6, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"a\", 11);\n    i0.ɵɵtext(8, \"Print Label\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"div\", 12)(10, \"div\", 13)(11, \"div\", 14)(12, \"div\", 15);\n    i0.ɵɵtext(13, \"SKU\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"div\", 16);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"div\", 14)(17, \"div\", 15);\n    i0.ɵɵtext(18, \"Barcode\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"div\", 16);\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(21, \"div\", 14)(22, \"div\", 15);\n    i0.ɵɵtext(23, \"Unit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"div\", 16);\n    i0.ɵɵtext(25);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(26, \"div\", 14)(27, \"div\", 15);\n    i0.ɵɵtext(28, \"Cost\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"div\", 16);\n    i0.ɵɵtext(30);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(31, \"div\", 14)(32, \"div\", 15);\n    i0.ɵɵtext(33, \"Price\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(34, \"div\", 16);\n    i0.ɵɵtext(35);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(36, \"div\", 14)(37, \"div\", 15);\n    i0.ɵɵtext(38, \"Category\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(39, \"div\", 16);\n    i0.ɵɵtext(40);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(41, \"div\", 14)(42, \"div\", 15);\n    i0.ɵɵtext(43, \"Brand\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(44, \"div\", 16);\n    i0.ɵɵtext(45);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(46, \"div\")(47, \"div\", 17);\n    i0.ɵɵtext(48, \"Description\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(49, \"div\", 18);\n    i0.ɵɵtext(50);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(51, \"div\", 19)(52, \"div\", 20);\n    i0.ɵɵtext(53, \"Barcode\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(54, ProductDetailComponent_div_2_div_54_Template, 3, 2, \"div\", 21)(55, ProductDetailComponent_div_2_div_55_Template, 2, 0, \"div\", 22);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(56, \"div\", 19)(57, \"div\", 23)(58, \"h2\", 24);\n    i0.ɵɵtext(59, \"Stock Levels\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(60, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function ProductDetailComponent_div_2_Template_button_click_60_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.showAddStockModal = true);\n    });\n    i0.ɵɵelement(61, \"lucide-icon\", 26);\n    i0.ɵɵtext(62, \" Add Stock \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(63, ProductDetailComponent_div_2_div_63_Template, 17, 20, \"div\", 27)(64, ProductDetailComponent_div_2_div_64_Template, 2, 0, \"div\", 28)(65, ProductDetailComponent_div_2_div_65_Template, 2, 0, \"div\", 29)(66, ProductDetailComponent_div_2_div_66_Template, 18, 1, \"div\", 30);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(67, ProductDetailComponent_div_2_app_modal_67_Template, 22, 4, \"app-modal\", 31)(68, ProductDetailComponent_div_2_app_modal_68_Template, 19, 3, \"app-modal\", 32);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r1.product.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(18, _c0, ctx_r1.product.id));\n    i0.ɵɵadvance(10);\n    i0.ɵɵtextInterpolate(ctx_r1.product.sku || \"-\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.product.barcode || \"-\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.product.uom || \"-\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.product.cost != null ? \"$\" + ctx_r1.Number(ctx_r1.product.cost).toFixed(2) : \"-\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.product.price != null ? \"$\" + ctx_r1.Number(ctx_r1.product.price).toFixed(2) : \"-\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.product.categoryName || \"-\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.product.brandName || \"-\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.product.description || \"No description provided.\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.product.barcode);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.product.barcode);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.stockLoading && ctx_r1.stock.length > 0);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.stockLoading);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.stockLoading && ctx_r1.stock.length === 0);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.stockLoading && ctx_r1.stock.length > 0);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.showAddStockModal);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.showAdjustStockModal && ctx_r1.selectedStock);\n  }\n}\nexport class ProductDetailComponent {\n  constructor(route, router, productsService, warehouseService, authService, toastr) {\n    this.route = route;\n    this.router = router;\n    this.productsService = productsService;\n    this.warehouseService = warehouseService;\n    this.authService = authService;\n    this.toastr = toastr;\n    this.product = null;\n    this.stock = [];\n    this.warehouses = [];\n    this.loading = true;\n    this.stockLoading = false;\n    this.showAddStockModal = false;\n    this.showAdjustStockModal = false;\n    this.selectedStock = null;\n    this.stockForm = {\n      warehouseId: '',\n      qty: '',\n      locationId: ''\n    };\n  }\n  ngOnInit() {\n    const id = this.route.snapshot.paramMap.get('id');\n    if (id) {\n      this.loadProduct(id);\n    }\n  }\n  loadProduct(id) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const token = _this.authService.token;\n      if (!token) return;\n      try {\n        _this.loading = true;\n        const [productRes, stockRes, warehousesRes] = yield Promise.all([_this.productsService.get(id).toPromise(), _this.productsService.stock(id).toPromise().catch(() => []), _this.warehouseService.list({\n          page: 1,\n          limit: 1000\n        }).toPromise()]);\n        _this.product = productRes;\n        _this.stock = stockRes || [];\n        _this.warehouses = warehousesRes?.warehouses || [];\n      } catch (error) {\n        _this.toastr.error(error?.message || 'Failed to load product');\n      } finally {\n        _this.loading = false;\n      }\n    })();\n  }\n  refreshStock() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      const id = _this2.route.snapshot.paramMap.get('id');\n      if (!id) return;\n      const token = _this2.authService.token;\n      if (!token) return;\n      try {\n        _this2.stockLoading = true;\n        const stockRes = yield _this2.productsService.stock(id).toPromise();\n        _this2.stock = stockRes || [];\n      } catch (error) {\n        console.error('Failed to refresh stock:', error);\n      } finally {\n        _this2.stockLoading = false;\n      }\n    })();\n  }\n  handleAddStock(e) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      e.preventDefault();\n      const id = _this3.route.snapshot.paramMap.get('id');\n      if (!id || !_this3.stockForm.warehouseId || !_this3.stockForm.qty) {\n        _this3.toastr.error('Please fill in warehouse and quantity');\n        return;\n      }\n      const token = _this3.authService.token;\n      if (!token) return;\n      try {\n        yield _this3.warehouseService.addStock({\n          productId: id,\n          warehouseId: _this3.stockForm.warehouseId,\n          qty: parseFloat(_this3.stockForm.qty),\n          locationId: _this3.stockForm.locationId || null\n        }).toPromise();\n        _this3.toastr.success('Stock added successfully');\n        _this3.showAddStockModal = false;\n        _this3.stockForm = {\n          warehouseId: '',\n          qty: '',\n          locationId: ''\n        };\n        yield _this3.refreshStock();\n      } catch (error) {\n        _this3.toastr.error(error?.message || 'Failed to add stock');\n      }\n    })();\n  }\n  handleAdjustStock(e) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      e.preventDefault();\n      const id = _this4.route.snapshot.paramMap.get('id');\n      if (!id || !_this4.selectedStock || !_this4.stockForm.qty) {\n        _this4.toastr.error('Please enter quantity');\n        return;\n      }\n      const token = _this4.authService.token;\n      if (!token) return;\n      try {\n        yield _this4.warehouseService.adjustStock({\n          productId: id,\n          warehouseId: _this4.selectedStock.warehouse?._id || _this4.selectedStock.warehouse,\n          qty: parseFloat(_this4.stockForm.qty),\n          locationId: _this4.stockForm.locationId || null\n        }).toPromise();\n        _this4.toastr.success('Stock adjusted successfully');\n        _this4.showAdjustStockModal = false;\n        _this4.selectedStock = null;\n        _this4.stockForm = {\n          warehouseId: '',\n          qty: '',\n          locationId: ''\n        };\n        yield _this4.refreshStock();\n      } catch (error) {\n        _this4.toastr.error(error?.message || 'Failed to adjust stock');\n      }\n    })();\n  }\n  openAdjustModal(stockItem) {\n    this.selectedStock = stockItem;\n    this.stockForm = {\n      warehouseId: stockItem.warehouse?._id || stockItem.warehouse,\n      qty: stockItem.qty || 0,\n      locationId: stockItem.location?._id || stockItem.location || ''\n    };\n    this.showAdjustStockModal = true;\n  }\n  get totalStock() {\n    return this.stock.reduce((sum, item) => sum + (item.qty || 0), 0);\n  }\n  get totalAvailable() {\n    return this.stock.reduce((sum, item) => sum + (item.availableQty || 0), 0);\n  }\n  get hasZeroStock() {\n    return this.totalStock === 0;\n  }\n  get hasLowStock() {\n    return this.totalStock > 0 && this.totalAvailable === 0;\n  }\n  formatLocation(location) {\n    if (!location) return '-';\n    const parts = [];\n    if (location.zone) parts.push(location.zone);\n    if (location.shelf) parts.push(location.shelf);\n    if (location.bin) parts.push(location.bin);\n    const result = parts.join('-');\n    return result || location.locationCode || '-';\n  }\n  static {\n    this.ɵfac = function ProductDetailComponent_Factory(t) {\n      return new (t || ProductDetailComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.ProductsService), i0.ɵɵdirectiveInject(i3.WarehouseService), i0.ɵɵdirectiveInject(i4.AuthService), i0.ɵɵdirectiveInject(i5.ToastrService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ProductDetailComponent,\n      selectors: [[\"app-product-detail\"]],\n      decls: 3,\n      vars: 3,\n      consts: [[\"class\", \"flex items-center justify-center py-20\", 4, \"ngIf\"], [\"class\", \"card p-6 text-center text-sm text-gray-600\", 4, \"ngIf\"], [\"class\", \"space-y-4\", 4, \"ngIf\"], [1, \"flex\", \"items-center\", \"justify-center\", \"py-20\"], [1, \"h-8\", \"w-8\"], [1, \"card\", \"p-6\", \"text-center\", \"text-sm\", \"text-gray-600\"], [1, \"space-y-4\"], [1, \"flex\", \"items-center\", \"justify-between\"], [1, \"page-title\"], [1, \"flex\", \"items-center\", \"gap-2\"], [1, \"btn\", \"btn-secondary\", 3, \"routerLink\"], [\"routerLink\", \"/barcodes/print\", 1, \"btn\", \"btn-primary\"], [1, \"grid\", \"grid-cols-1\", \"lg:grid-cols-3\", \"gap-4\"], [1, \"card\", \"p-4\", \"space-y-3\", \"lg:col-span-2\"], [1, \"grid\", \"grid-cols-3\", \"gap-2\", \"py-2\", \"border-b\", \"last:border-b-0\"], [1, \"text-sm\", \"text-gray-500\"], [1, \"col-span-2\", \"text-sm\", \"text-gray-800\"], [1, \"label\", \"mb-1\"], [1, \"text-sm\", \"text-gray-700\", \"whitespace-pre-line\"], [1, \"card\", \"p-4\"], [1, \"label\", \"mb-2\"], [\"class\", \"flex flex-wrap items-center gap-3\", 4, \"ngIf\"], [\"class\", \"text-sm text-gray-500\", 4, \"ngIf\"], [1, \"flex\", \"items-center\", \"justify-between\", \"mb-4\"], [1, \"text-lg\", \"font-semibold\"], [1, \"btn\", \"btn-primary\", \"flex\", \"items-center\", \"gap-2\", 3, \"click\"], [\"name\", \"plus\", 1, \"h-4\", \"w-4\"], [\"class\", \"mb-4 p-3 rounded-lg border\", 3, \"ngClass\", 4, \"ngIf\"], [\"class\", \"text-center py-4\", 4, \"ngIf\"], [\"class\", \"text-center py-8 text-gray-500\", 4, \"ngIf\"], [\"class\", \"overflow-x-auto\", 4, \"ngIf\"], [\"title\", \"Add Stock\", 3, \"open\", \"close\", 4, \"ngIf\"], [\"title\", \"Adjust Stock\", 3, \"open\", \"close\", 4, \"ngIf\"], [1, \"flex\", \"flex-wrap\", \"items-center\", \"gap-3\"], [\"type\", \"code128\", 3, \"value\"], [\"type\", \"qr\", 3, \"value\"], [1, \"mb-4\", \"p-3\", \"rounded-lg\", \"border\", 3, \"ngClass\"], [\"name\", \"alert-triangle\", \"class\", \"text-red-600 h-5 w-5\", 4, \"ngIf\"], [\"name\", \"alert-triangle\", \"class\", \"text-orange-600 h-5 w-5\", 4, \"ngIf\"], [1, \"text-sm\", \"font-medium\", \"text-gray-700\"], [3, \"ngClass\"], [1, \"text-xs\", \"text-gray-600\", \"mt-0.5\"], [\"class\", \"text-sm text-red-700 hover:text-red-900 font-medium underline\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"mt-2 text-sm text-red-700\", 4, \"ngIf\"], [\"class\", \"mt-2 text-sm text-orange-700\", 4, \"ngIf\"], [\"name\", \"alert-triangle\", 1, \"text-red-600\", \"h-5\", \"w-5\"], [\"name\", \"alert-triangle\", 1, \"text-orange-600\", \"h-5\", \"w-5\"], [1, \"text-sm\", \"text-red-700\", \"hover:text-red-900\", \"font-medium\", \"underline\", 3, \"click\"], [1, \"mt-2\", \"text-sm\", \"text-red-700\"], [1, \"mt-2\", \"text-sm\", \"text-orange-700\"], [1, \"text-center\", \"py-4\"], [1, \"h-6\", \"w-6\", \"mx-auto\"], [1, \"text-center\", \"py-8\", \"text-gray-500\"], [1, \"overflow-x-auto\"], [1, \"w-full\"], [1, \"border-b\"], [1, \"text-left\", \"py-2\", \"px-3\", \"text-sm\", \"font-medium\", \"text-gray-700\"], [1, \"text-right\", \"py-2\", \"px-3\", \"text-sm\", \"font-medium\", \"text-gray-700\"], [1, \"text-center\", \"py-2\", \"px-3\", \"text-sm\", \"font-medium\", \"text-gray-700\"], [\"class\", \"border-b hover:bg-gray-50\", 3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [1, \"border-b\", \"hover:bg-gray-50\", 3, \"ngClass\"], [1, \"py-2\", \"px-3\", \"text-sm\"], [1, \"py-2\", \"px-3\", \"text-sm\", \"text-gray-600\"], [1, \"py-2\", \"px-3\", \"text-sm\", \"text-right\", \"font-medium\"], [1, \"flex\", \"items-center\", \"justify-end\", \"gap-1\"], [\"name\", \"alert-triangle\", \"class\", \"text-red-500 h-3.5 w-3.5\", 4, \"ngIf\"], [1, \"py-2\", \"px-3\", \"text-sm\", \"text-right\"], [1, \"py-2\", \"px-3\", \"text-sm\", \"text-right\", \"text-orange-600\"], [1, \"py-2\", \"px-3\", \"text-center\"], [1, \"text-blue-600\", \"hover:text-blue-800\", \"flex\", \"items-center\", \"gap-1\", \"mx-auto\", 3, \"click\"], [3, \"name\", \"size\"], [\"name\", \"alert-triangle\", 1, \"text-red-500\", \"h-3.5\", \"w-3.5\"], [\"title\", \"Add Stock\", 3, \"close\", \"open\"], [1, \"space-y-4\", 3, \"ngSubmit\"], [1, \"label\"], [1, \"text-red-500\"], [\"name\", \"warehouseId\", \"required\", \"\", 1, \"input\", 3, \"ngModelChange\", \"ngModel\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"number\", \"step\", \"0.01\", \"min\", \"0.01\", \"name\", \"qty\", \"required\", \"\", 1, \"input\", 3, \"ngModelChange\", \"ngModel\"], [1, \"flex\", \"gap-2\", \"pt-4\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"flex-1\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", \"flex-1\", 3, \"click\"], [3, \"value\"], [\"title\", \"Adjust Stock\", 3, \"close\", \"open\"], [\"type\", \"text\", \"disabled\", \"\", 1, \"input\", \"bg-gray-100\", 3, \"value\"], [\"type\", \"number\", \"step\", \"0.01\", \"min\", \"0\", \"name\", \"qty\", \"required\", \"\", 1, \"input\", 3, \"ngModelChange\", \"ngModel\"], [1, \"text-xs\", \"text-gray-500\", \"mt-1\"]],\n      template: function ProductDetailComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵtemplate(0, ProductDetailComponent_div_0_Template, 2, 0, \"div\", 0)(1, ProductDetailComponent_div_1_Template, 2, 0, \"div\", 1)(2, ProductDetailComponent_div_2_Template, 69, 20, \"div\", 2);\n        }\n        if (rf & 2) {\n          i0.ɵɵproperty(\"ngIf\", ctx.loading);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading && !ctx.product);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading && ctx.product);\n        }\n      },\n      dependencies: [i6.NgClass, i6.NgForOf, i6.NgIf, i7.ɵNgNoValidate, i7.NgSelectOption, i7.ɵNgSelectMultipleOption, i7.DefaultValueAccessor, i7.NumberValueAccessor, i7.SelectControlValueAccessor, i7.NgControlStatus, i7.NgControlStatusGroup, i7.RequiredValidator, i7.MinValidator, i7.NgModel, i7.NgForm, i1.RouterLink, i8.SpinnerComponent, i9.ModalComponent, i10.BarcodePreviewComponent, i11.LucideIconComponent]\n    });\n  }\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}